image: node

stages:
  - test

cache:
  key: ${CI_COMMIT_REF_SLUG}
  paths:
    - node_modules/
    - .next/cache/

test:
  variables:
    DATABASE_URL: "postgresql://postgres:example@localhost:5432/postgres?schema=public"
    NEXTAUTH_URL: http://localhost:3000/api/auth
    ALLOW_REGISTRATION_FROM: bigdataboutique.com
    QUERY_EXPANDER_URL: http://localhost:8080
    GOOGLE_ID: "unset_google_id"
    GOOGLE_SECRET: "unset_google_secret"
  stage: test
  script:
    - yarn
    - yarn build

